(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8783:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var n=r(26265),c=r(809),a=r.n(c),o=r(85893),s=r(92447),i=r(9008),u=r(67294),l=r(39227),d=r(16592),p=r(86373),f=p.EthereumAuthProvider,h=p.SelfID,x=p.WebClient;function m(){return b.apply(this,arguments)}function b(){return(b=(0,s.Z)(a().mark((function e(){var t,r,n,c,o,s,i,u,d,p,m,b,w,y,v,g,j=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=j.length>0&&void 0!==j[0]?j[0]:{},r=t.ceramicNetwork,n=void 0===r?"testnet-clay":r,c=t.connectNetwork,o=void 0===c?"testnet-clay":c,s=t.address,i=void 0===s?"":s,u=t.provider,d=void 0===u?null:u,p=t.client,m=void 0===p?null:p,b=window.ethereum){e.next=4;break}return e.abrupt("return",{error:"No ethereum wallet detected"});case 4:if(m||(m=new x({ceramic:n,connectNetwork:o})),i){e.next=11;break}return e.next=8,b.request({method:"eth_requestAccounts"});case 8:w=e.sent,y=(0,l.Z)(w,1),i=y[0];case 11:return d||(d=new f(window.ethereum,i)),e.next=14,m.authenticate(d);case 14:return v=new h({client:m}),g=v.did._id,e.abrupt("return",{client:m,id:g,selfId:v,error:null});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w={ethereum:"@eip155:1",bitcoin:"@bip122:000000000019d6689c085ae165831e93",cosmos:"@cosmos:cosmoshub-3",kusama:"@polkadot:b0a8d493285c2df73290dfb7e61f870f"};function y(){return v.apply(this,arguments)}function v(){return(v=(0,s.Z)(a().mark((function e(){var t,r,n,c,o,s,i,u,p,f,h,x,m,b,y,v,g,j=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=j.length>0&&void 0!==j[0]?j[0]:{},r=t.ceramicNetwork,n=void 0===r?"testnet-clay":r,c=t.network,o=void 0===c?"ethereum":c,s=t.client,i=void 0===s?null:s,u=t.schema,p=void 0===u?"basicProfile":u,f=t.address,h=void 0===f?null:f,x=window.ethereum){e.next=4;break}return e.abrupt("return",{error:"No ethereum wallet detected"});case 4:if(i||(i=new d.QY({ceramic:n})),h){e.next=11;break}return e.next=8,x.request({method:"eth_requestAccounts"});case 8:b=e.sent,y=(0,l.Z)(b,1),h=y[0];case 11:return v=w[o],e.next=14,i.getAccountDID("".concat(h).concat(v));case 14:return g=e.sent,e.next=17,i.get(p,g);case 17:return m=e.sent,console.log("record: ",m),e.abrupt("return",{record:m,error:null});case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(){var e=(0,u.useState)(""),t=e[0],r=e[1],n=(0,u.useState)(""),c=n[0],l=n[1],d=(0,u.useState)(""),p=d[0],f=d[1],h=(0,u.useState)({}),x=h[0],b=h[1],w=(0,u.useState)(null),v=w[0],g=w[1],k=(0,u.useState)(null),N=k[0],O=k[1],P=(0,u.useState)(!1),_=P[0],C=P[1],S=(0,u.useState)(!1),D=S[0],Z=S[1],E=(0,u.useRef)(null),A=(0,u.useRef)(null);function I(){return T.apply(this,arguments)}function T(){return(T=(0,s.Z)(a().mark((function e(){var t,r,n,c,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:if(t=e.sent,r=t.id,n=t.selfId,!(c=t.error)){e.next=7;break}return console.log("error: ",c),e.abrupt("return");case 7:return g(r),O(n),e.next=11,n.get("basicProfile",r);case 11:(o=e.sent)?b(o):Z(!0),C(!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=(0,s.Z)(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c||t||p){e.next=3;break}return console.log("error... no profile information submitted"),e.abrupt("return");case 3:if(N){e.next=6;break}return e.next=6,I();case 6:return r=j({},x),c&&(r.twitter=c),t&&(r.bio=t),p&&(r.name=p),e.next=12,E.current.set("basicProfile",r);case 12:X(),console.log("profile updated...");case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){return F.apply(this,arguments)}function F(){return(F=(0,s.Z)(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y();case 3:t=e.sent,(r=t.record)?b(r):Z(!0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),Z(!0);case 11:C(!0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function X(){return Y.apply(this,arguments)}function Y(){return(Y=(0,s.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.current.get("basicProfile",A.current.id);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:b(t),Z(!1),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("error",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}return E.current=N,A.current=v,(0,o.jsxs)("div",{children:[(0,o.jsxs)(i.default,{children:[(0,o.jsx)("title",{children:"Create Next App"}),(0,o.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,o.jsx)("div",{style:{paddingTop:50,width:500,margin:"0 auto",display:"flex",flex:1},children:(0,o.jsxs)("div",{className:"flex flex-1 flex-col justify-center",children:[(0,o.jsx)("h1",{className:"text-5xl text-center",children:"Decentralized Identity"}),(0,o.jsx)("p",{className:"text-xl text-center mt-2 text-gray-400",children:"An authentication flow built with Ceramic & IDX"}),Object.keys(x).length?(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("h2",{className:"text-2xl font-semibold mt-6",children:x.name}),(0,o.jsx)("p",{className:"text-gray-500 text-sm my-1",children:x.bio}),x.twitter&&(0,o.jsxs)("p",{className:"text-lg\ttext-gray-900",children:["Follow me on Twitter - @",x.twitter]})]}):null,!_&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{onClick:I,className:"pt-4 shadow-md bg-purple-800 mt-4 mb-2 text-white font-bold py-2 px-4 rounded",children:"Authenticate"}),(0,o.jsx)("button",{className:"pt-4 shadow-md bg-blue-500 mb-2 text-white font-bold py-2 px-4 rounded",onClick:R,children:"Read Profile"})]}),_&&D&&(0,o.jsx)("p",{className:"my-4 font-bold text-center",children:"You have no profile yet. Please create one!"}),_&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{className:"pt-4 rounded bg-gray-100 px-3 py-2",placeholder:"Name",onChange:function(e){return f(e.target.value)}}),(0,o.jsx)("input",{className:"pt-4 rounded bg-gray-100 px-3 py-2 my-2",placeholder:"Bio",onChange:function(e){return r(e.target.value)}}),(0,o.jsx)("input",{className:"pt-4 rounded bg-gray-100 px-3 py-2",placeholder:"Twitter username",onChange:function(e){return l(e.target.value)}}),(0,o.jsx)("button",{className:"pt-4 shadow-md bg-green-500 mt-2 mb-2 text-white font-bold py-2 px-4 rounded",onClick:function(){return q.apply(this,arguments)},children:"Update Profile"}),(0,o.jsx)("button",{className:"pt-4 shadow-md bg-blue-500 mb-2 text-white font-bold py-2 px-4 rounded",onClick:R,children:"Read Profile"})]})]})})]})}},78581:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(8783)}])},35883:function(){},46601:function(){},71456:function(){},89214:function(){},73105:function(){},55024:function(){}},function(e){e.O(0,[514,774,888,179],(function(){return t=78581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);